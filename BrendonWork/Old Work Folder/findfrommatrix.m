function [lst,contsthresh] = findfrommatrix(a,cutoff,areath,maxarea)% function lst = findfrommatrix(a,cutoff,areath,maxarea)%lst = findcells(fin, cutoff,areath)%   takes image data from matrix input (a), detects cells with a given%   cutoff, and%   outputs a cell array containing coordinates of all contoursfigure;imagesc(a);colormap(gray);set(gcf,'position',[1, 29, 1024, 672]);set(gca,'ydir','reverse');axis equal;axis off;hold on;[c h] = contour(a,[cutoff cutoff],'-r');lst = {};for c = 1:size(h,1)   coords = [get(h(c),'xdata')' get(h(c),'ydata')'];   if coords(1,:) == coords(end,:)      if poly_area(round(coords(1:end-1,:))) > areath & poly_area(round(coords(1:end-1,:))) < maxarea;         lst{size(lst,2)+1} = coords(1:end-1,:);         lst{size(lst,2)}=[lst{size(lst,2)};lst{size(lst,2)}(1,:)];      else         delete(h(c));      end   else      delete(h(c));   endend%delete(gcf);contsthresh=[cutoff areath maxarea];